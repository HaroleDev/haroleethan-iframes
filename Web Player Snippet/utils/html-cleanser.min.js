/**
 * @module @graficos/html-cleanser
 * @version 0.3.0
 * Minified by Harole (https://github.com/HaroleDev) using JavaScript Minify Tool (https://github.com/do-community/minify-tool) with Terser 5.14.2
 * @license MIT
 */
 let e=["script","img","a","object","iframe","embed","input","textarea","button","link","style","base"],r=/(datasrc="?(.*?)"?)>/gi,a=/(use="?(.*?)"?)>/gi,i=/(src="?(.*?)"?)>/gi,t=/<\s?\/?\s?([a-z0-9]*)\b[^>]*\s?>?/gi,c=RegExp(`(${[/<!--[\s\S]*?-->/gi,/javascript:\/\*-->/gi,/Set\.constructor`/gi,/<\?xml/gi,/url\s?\(.*?\)/gi,/document\.write/gi].map(({source:s})=>s).join("|")})`,"gi");export const cleanHTML=(s,l="<i><em><span><p>")=>{if(!s)return"";if(e.some(s=>l.includes(`<${s}>`)))throw Error("Disallowed tags: "+l);l=((l+"").toLowerCase().match(/<[a-z0-9]+>/g)||[]).join("");let o=s;for(o=o.replace(/<$/,"");;){let p=o;if(o=p.replace(c,"").replace(r,(s,l)=>s.replace(l,"")).replace(i,(s,l)=>s.replace(l,"")).replace(a,(s,l)=>s.replace(l,"")).replace(t,(s,o)=>l.includes(`<${o.toLowerCase()}>`)?s:""),p===o)return o}}
