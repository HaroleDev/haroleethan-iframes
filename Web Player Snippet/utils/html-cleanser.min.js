/**@module @graficos/html-cleanser * @author Paul Melero<https://graficos.net> * Minified by Harole <https://github.com/HaroleDev> * @license MIT*/
const e=['script','img','a','object','iframe','embed','input','textarea','button','link','style','base'],r=/(datasrc='?(.*?)'?)>/gi,a=/(use='?(.*?)'?)>/gi,i=/(src='?(.*?)'?)>/gi,t=/<\s?\/?\s?([a-z0-9]*)\b[^>]*\s?>?/gi,c=new RegExp(`(${[/<!--[\s\S]*?-->/gi,/javascript:\/\*-->/gi,/Set\.constructor`/gi,/<\?xml/gi,/url\s?\(.*?\)/gi,/document\.write/gi].map(({source:e})=>e).join('|')})`,'gi');export const cleanHTML=(s,o='<c><i><b><u><ruby><rt><v><lang>')=>{if(!s)return'';if(e.some(e=>o.includes(`<${e}>`)))throw Error('Disallowed tags: '+o);o=((o+'').toLowerCase().match(/<[a-z0-9]+>/g)||[]).join('');let l=s;for(l=l.replace(/<$/,'');;){let e=l;if(l=e.replace(c,'').replace(r,(e,r)=>e.replace(r,'')).replace(i,(e,r)=>e.replace(r,'')).replace(a,(e,r)=>e.replace(r,'')).replace(t,(e,r)=>o.includes(`<${r.toLowerCase()}>`)?e:''),e===l)return l}}
//# sourceMappingURL=html-cleanser.min.js.map
